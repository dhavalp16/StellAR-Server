# MajorServer üöÄ

The backend powerhouse for the **StellAR** Augmented Reality platform.
This Flask server handles 3D model generation (via ComfyUI), manages the Cloud Database (Supabase), and serves APIs to the Unity client.

## ‚ú® Features
*   **AI 3D Generation**: Connects to a local ComfyUI instance to turn images into `.glb` models.
*   **Cloud Storage**: Uploads generated models to **Supabase Storage**.
*   **Gamification Logic**: Automatically assigns Rarity (Common to Legendary) and XP rewards to new models.
*   **Dynamic API**: Serves the list of discoverable models to the AR App.

## üõ†Ô∏è Prerequisites
*   **Python 3.10+**
*   **ComfyUI**: Must be installed and running locally.
*   **PostgreSQL / Supabase**: For database and storage.

## üì¶ Installation

1.  **Clone the repository**:
    ```bash
    git clone https://github.com/dhavalp16/StellAR-Server.git
    cd StellAR-Server
    ```

2.  **Create Virtual Environment**:
    ```bash
    python -m venv venv
    .\venv\Scripts\activate
    ```

3.  **Install Dependencies**:
    ```bash
    pip install -r requirements.txt
    ```

## ‚öôÔ∏è Configuration

1.  **Environment Variables**:
    Create a `.env` file in the root directory:
    ```ini
    SUPABASE_URL=your_supabase_url
    SUPABASE_KEY=your_supabase_anon_key
    JWT_SECRET_KEY=your_secret_key
    ```

2.  **ComfyUI Setup**:
    *   Ensure ComfyUI is running on `http://127.0.0.1:8188`.
    *   This server expects the `Hunyuan3D` workflow.

3.  **Database Setup**:
    Run the following SQL in your Supabase SQL Editor:
    ```sql
    create table models (
      id bigint generated by default as identity primary key,
      name text,
      description text,
      storage_url text,
      rarity text,
      xp_reward int,
      uploader_id int,
      metadata jsonb,
      created_at timestamp with time zone default timezone('utc'::text, now())
    );
    
    -- Enable uploads
    create policy "Allow Public Uploads" on storage.objects for insert with check ( bucket_id = 'models' );
    ```

## üöÄ Usage

**Start the Server**:
```bash
python app.py
```

**API Endpoints**:
*   `GET /api/models/`: List all discoverable models (JSON).
*   `POST /api/models/generate`: Upload an image to generate a 3D model.
    *   Form Data: `file` (image), `name` (string), `prompt` (string).
*   `POST /api/auth/register`: Create a user.
*   `POST /api/auth/login`: Get a JWT token.

## ü§ù Contribution
1.  Fork the repo.
2.  Create your feature branch.
3.  Commit changes.
4.  Push to branch and open a PR.
